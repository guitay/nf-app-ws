<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="pas_QUERY_UTIL">

	<!-- 取得用户分配权限的业务类别,调用存储过程sp_PasSYS_CHECKRIGHT -->
	<resultMap id="query_KhdxProceResult"
		class="com.tiancom.pas.common.proc.entity.QueryUtilPojo">
		<result column="ywlb" property="ywlb" jdbcType="CHAR" />
		<result column="ms" property="ms" jdbcType="VARCHAR" />
	</resultMap>

	<parameterMap id="query_KhdxProcePara" class="java.util.Map">
		<parameter property="rightType" jdbcType="VARCHAR"
			javaType="java.lang.String" mode="IN" />
		<parameter property="hydh" jdbcType="VARCHAR"
			javaType="java.lang.String" mode="IN" />
		<parameter property="hymm" jdbcType="VARCHAR"
			javaType="java.lang.String" mode="IN" />
		<parameter property="hyDate" jdbcType="INTEGER"
			javaType="java.lang.String" mode="IN" />
		<parameter property="result" jdbcType="ORACLECURSOR" javaType="java.sql.ResultSet" mode="OUT" /> 
	</parameterMap>

	<procedure id="query_selectOperFromProce"
		resultMap="query_KhdxProceResult"
		parameterMap="query_KhdxProcePara">
		{call sp_PasSYS_CHECKRIGHT(?,?,?,?,?)}
	</procedure>

   

	<!-- 取得用户分配权限的行员,调用存储过程sp_PasSYS_CHECKRIGHT -->
	<resultMap id="query_KhdxHyProceResult"
		class="com.tiancom.pas.common.proc.entity.QueryUtilPojo">
		<result column="jgdh" property="jgdh" jdbcType="CHAR" />
		<result column="hydh" property="hydh" jdbcType="CHAR" />
		<result column="khdxdh" property="khdxdh" jdbcType="INTEGER" />
		<result column="hymc" property="hymc" jdbcType="VARCHAR" />
		<result column="jgkhdxdh" property="jgkhdxdh"
			jdbcType="INTEGER" /> 
	</resultMap>

    <select id="query_select_allhy_util"  parameterClass="java.util.Map" resultMap="query_KhdxHyProceResult">
             select jg.jgdh,hy.hydh,hy.khdxdh,hy.hymc,jg.jgkhdxdh from KHDX_HYhy 
             inner  join KHDX_JGCY  cy on cy.khdxdh=hy.khdxdh and $tjrq$ between cy.qsrq and cy.jsrq
             inner join KHDX_JG jg on jg.khdxdh=cy.jgkhdxdh 
             <isNotEmpty prepend="AND" property="jgjb">
	         <![CDATA[
	         inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh and $tjrq$ between cc.qsrq and cc.jsrq and cc.jgjb<=$jgjb$
	         ]]>
	          </isNotEmpty>
	          <isNotEmpty prepend="AND" property="xnhy">
	             where hy. xnhybz='Y'
	          </isNotEmpty>
    </select>

	<procedure id="query_selectHyFromProce"
		resultMap="query_KhdxHyProceResult"
		parameterMap="query_KhdxProcePara">
		{call sp_PasSYS_CHECKRIGHT(?,?,?,?,?)}
	</procedure>

	<select id="selectExistsChildJgByPara"
		resultClass="java.lang.Integer" parameterClass="java.util.Map">
		select count(1) from KHDX_JGCC where sjkhdxdh=$khdxdh$ 
		and $tjrq$  between qsrq and jsrq
	</select>
	
		
   <resultMap id="query_JgResult" class="com.tiancom.pas.common.proc.entity.QueryUtilPojo" >
    <result column="khdxdh" property="khdxdh" jdbcType="INTEGER" />
    <result column="jgdh" property="jgdh" jdbcType="VARCHAR" />
    <result column="jgmc" property="jgmc" jdbcType="VARCHAR" />
    <result column="sjkhdxdh" property="sjkhdxdh" jdbcType="INTEGER" />
    <result column="jgjb" property="jgjb" jdbcType="INTEGER" />
  </resultMap>
  
  	<select id="selectJgListBySjJgdh" resultMap="query_JgResult"
		parameterClass="java.util.Map">
		select jg.jgdh, jg.khdxdh, jg.jgmc, cc.sjkhdxdh, cc.jgjb 
		from KHDX_JG jg 
		inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh
		where cc.sjkhdxdh=$khdxdh$ and cc.jgjb>=1 and $tjrq$ between qsrq and jsrq
	</select>
   
   <procedure id="query_selectJgFromProce"
		resultMap="query_JgResult"
		parameterMap="query_KhdxProcePara">
		{call sp_PasSYS_CHECKRIGHT(?,?,?,?,?)}
	</procedure>
	<select id="query_selectAllJgForViewAqjs" resultMap="query_JgResult" parameterClass="java.util.Map">
		  
		select jg.khdxdh,jg.jgdh,jg.jgmc,jgcc.sjkhdxdh as sjkhdxdh,jgcc.jgjb  from KHDX_JG jg 
		inner join khdx_Jgcc jgcc on jg.khdxdh = jgcc.khdxdh and jgcc.jsrq = 29991231
		
	</select>
	<!-- 
		sxfs-刷新方式
		dh-当为按角色代号刷新时传入角色代号，当为按用户考核对象代号刷新时传入用户考核对象代号,当为全量刷新时此字段可传入任何值
	 -->
	
	<parameterMap id="query_SP_PASSYS_RIGHT_INIT_Para" class="java.util.Map">
		<parameter property="sxfs" jdbcType="INTEGER"
			javaType="java.lang.Integer" mode="IN" />
		<parameter property="dh" jdbcType="INTEGER"
			javaType="java.lang.Integer" mode="IN" />
		<parameter property="result" jdbcType="INTEGER" javaType="java.lang.Integer" mode="OUT" /> 
	</parameterMap>
	
   <procedure id="query_SP_PASSYS_RIGHT_INIT"
		resultClass="java.lang.Integer"
		parameterMap="query_SP_PASSYS_RIGHT_INIT_Para">
		{call SP_PASSYS_RIGHT_INIT(?,?,?)}
	</procedure>
	
	
	
	
	<parameterMap id="query_SP_PASSYS_JGGX_INIT_Para" class="java.util.Map">
		<parameter property="result" jdbcType="INTEGER" javaType="java.lang.Integer" mode="OUT" /> 
	</parameterMap>
	
   <procedure id="query_SP_PASSYS_JGGX_INIT"
		resultClass="java.lang.Integer"
		parameterMap="query_SP_PASSYS_JGGX_INIT_Para">
		{call SP_PASSYS_JGGX_INIT(?)}
	</procedure>
	
	
	<insert id="KHDX_JG_saveAuthRoles" parameterClass="java.util.HashMap">
		insert into xtb_jssjqx (jsdh,ywlb,jgkhdxdh,ckhybz)
		select jsdh,ywlb,$jgkhdxdh$,'Y' from xtb_aqjs,csb_ywlb 
		where jsdh = -1 or jslx = 1
	</insert>
	
	<select id="selectQxkhdxdh" resultClass="java.lang.Integer">
		select khdxdh from KHDX_JGCC where sjkhdxdh=0 and jsrq=29991231
	</select>
	
	
	<resultMap id="jg_Result" class="com.tiancom.pas.common.proc.entity.QueryUtilPojo" >
    <result column="khdxdh" property="khdxdh" jdbcType="INTEGER" />
    <result column="jgdh" property="jgdh" jdbcType="CHAR" />
    <result column="jgmc" property="jgmc" jdbcType="VARCHAR" />
    <result column="sjkhdxdh" property="sjkhdxdh" jdbcType="INTEGER" />
    <result column="jgjb" property="jgjb" jdbcType="INTEGER" />
    <result column="pxbz" property="pxbz" jdbcType="INTEGER" />
  </resultMap>
	
	
   <select id="KHDX__selecJgtChildByKhdxdh" 
   		resultMap="jg_Result" 
   		parameterClass="java.util.Map" > 
    select jg.khdxdh, jg.jgdh, jg.jgmc, cc.sjkhdxdh, jg.pxbz, cc.jgjb 
    from KHDX_JG  jg
    inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh and $tjrq$ between cc.qsrq and cc.jsrq
    where  1=1
    <isNotEmpty prepend="AND" property="khdxdh">
			<![CDATA[
	      	cc.sjkhdxdh = #khdxdh#
			]]>
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="jgjb">
	<![CDATA[
	      cc.jgjb<=$jgjb$
	]]>
	</isNotEmpty>
	order by pxbz 
  </select>
  
   <select id="KHDX__selecJgByKey" 
   		resultMap="jg_Result" 
   		parameterClass="java.util.Map" > 
    select jg.khdxdh,jg.jgdh,jg.jgmc,cc.sjkhdxdh,cc.jgjb,jg.pxbz from KHDX_JG jg
    inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh and $tjrq$ between qsrq and jsrq
    where jg.khdxdh = $khdxdh$ 
  </select>
  
  
  <resultMap id="jgJs_Result" class="com.tiancom.pas.common.proc.entity.QueryUtilPojo" >
    <result column="khdxdh" property="khdxdh" jdbcType="INTEGER" />
    <result column="jgdh" property="jgdh" jdbcType="CHAR" />
    <result column="jgmc" property="jgmc" jdbcType="VARCHAR" />
    <result column="sjkhdxdh" property="sjkhdxdh" jdbcType="INTEGER" />
    <result column="jgjb" property="jgjb" jdbcType="INTEGER" />
    <result column="pxbz" property="pxbz" jdbcType="INTEGER" />
    <result column="bz" property="bz" jdbcType="INTEGER" />
  </resultMap>
  
   <select id="KHDX__selecJgByjsdh" resultMap="jgJs_Result" parameterClass="java.util.Map" >
    <isEqual property="queryType" compareValue="1">
    select distinct jg.khdxdh,jg.jgdh,jg.jgmc, cc.sjkhdxdh, jg.pxbz,cc.jgjb,case when jsdh is null then 0 else 1 end as bz from KHDX_JG jg
    inner join KHDX_JGCC cc on cc.khdxdh =jg.khdxdh and $tjrq$ between cc.qsrq and cc.jsrq
    
     <isNotEmpty property="qx">
    	
    	inner join (
			    select jgkhdxdh from  xtb_jssjqx
			    where jsdh = $dlhyjsdh$ and ckhybz = '$hyckbz$'
			    union
			    select jgkhdxdh from  xtb_yhsjqxst
			    where jsdh = $dlhyjsdh$ and hykhdxdh = $dlhykhdxdh$ and ckhybz='$hyckbz$'
			    and $tjrq$ between qsrq and jsrq
			) v on jg.khdxdh = v.jgkhdxdh 
    	
    	
    </isNotEmpty>
    
    left join XTB_JSSJQX js  on jg.khdxdh = js.jgkhdxdh 
	<isNotEmpty prepend="AND" property="dh">
		<![CDATA[
      	js.jsdh = $dh$
		]]>
	</isNotEmpty>
    where 1=1
	<isNotEmpty prepend="AND" property="khdxdh">
			<![CDATA[
	      	cc.sjkhdxdh = #khdxdh#
			]]>
	</isNotEmpty>
	order by pxbz
   </isEqual>
  </select>
  
   <select id="KHDX__selecCheckedJgByjsdh" resultMap="jgJs_Result" parameterClass="java.util.Map" >
    <isEqual property="queryType" compareValue="1">
    select distinct jg.khdxdh,jg.jgdh,jg.jgmc, cc.sjkhdxdh, jg.pxbz,cc.jgjb,case when jsdh is null then 0 else 1 end as bz from KHDX_JG jg
    inner join KHDX_JGCC cc on cc.khdxdh =jg.khdxdh and $tjrq$ between cc.qsrq and cc.jsrq
     <isNotEmpty property="qx">
    	inner join (
			    select jgkhdxdh from  xtb_jssjqx
			    where jsdh = $dh$ and ckhybz = '$hyckbz$'
			    union
			    select jgkhdxdh from  xtb_yhsjqxst
			    where jsdh = $dh$ and ckhybz='$hyckbz$'
			    and $tjrq$ between qsrq and jsrq
			) v on jg.khdxdh = v.jgkhdxdh 
    </isNotEmpty>
    left join XTB_JSSJQX js  on jg.khdxdh = js.jgkhdxdh 
	<isNotEmpty prepend="AND" property="dh">
		<![CDATA[
      	js.jsdh = $dh$
		]]>
	</isNotEmpty>
    where 1=1
	<isNotEmpty prepend="AND" property="khdxdh">
			<![CDATA[
	      	cc.sjkhdxdh = #khdxdh#
			]]>
	</isNotEmpty>
	order by pxbz
   </isEqual>
  </select>
   <select id="select_xtcs" resultClass="java.lang.String" parameterClass="java.lang.String" >
      select csz from XTB_XTCS where csmc='$csmc$'
   </select>
   
   <select id="select_xtcsQsrq" resultClass="java.lang.String" parameterClass="java.lang.String" >
      select csz from XTB_XTCS where csmc='$csmc$' and jsrq=29991231
   </select>
  
   <resultMap id="select_KhdxHyResult"
		class="com.tiancom.pas.common.proc.entity.QueryUtilPojo">
		<result column="hydh" property="hydh" jdbcType="CHAR" />
		<result column="khdxdh" property="khdxdh" jdbcType="INTEGER" />
		<result column="hymc" property="hymc" jdbcType="VARCHAR" />
	</resultMap>
  
   <select id="select_hyByHydhNotQx" parameterClass="java.util.Map" resultMap="select_KhdxHyResult">
       select hydh,hymc,khdxdh from KHDX_HYwhere hydh like '$hydh$%' 
   </select>
   
   <select id="select_hyByHydhQx" parameterClass="java.util.Map" resultMap="select_KhdxHyResult">
       select hy.hydh,hy.hymc,hy.khdxdh from KHDX_HYhy
       inner join KHDX_JGCY cy on cy.khdxdh=hy.khdxdh and $tjrq$ between cy.qsrq and cy.jsrq
       inner join V_YHQX_JGKHDH qx on qx.jgkhdxdh=cy.jgkhdxdh and qx.hydh='$qxhydh$' 
       and $tjrq$ between qx.qsrq and qx.jsrq
       where hy.hydh like '$hydh$%' 
   </select>
   
   <select id="select_sdbs_list" resultClass="java.util.HashMap"
		parameterClass="java.util.Map" remapResults="true">
		select dmz,dmms from csb_dmms a where lower(dmmc)='zbsdbs' and dmz in (select distinct sdbs from khdx_zbsd) 
   </select>
   
   <resultMap id="hyqsfx_zb_Result" class="com.tiancom.pas.common.proc.entity.QueryUtilPojo" >
       <result column="zbdh" property="zbdh" jdbcType="INTEGER" />
       <result column="zbmc" property="zbmc" jdbcType="VARCHAR" />
   </resultMap>
   <select id="select_fx_zb" resultMap="hyqsfx_zb_Result" parameterClass="java.util.Map" >
        select distinct zb.zbdh,zb.zbmc from khdx_zb zb
	  inner join khdx_zblb lb on zb.zbdh = lb.zbdh and  #tjrq:INTEGER# between lb.qsrq and lb.jsrq
	  inner join khdx_zbsd sd on zb.zbdh=sd.zbdh 
	  inner join khdx_zbbz zbbz on zb.zbdh=zbbz.zbdh
	        where 1=1
        <isNotEmpty prepend="AND" property="ywlb">
			<![CDATA[
	      	   lb.ywlb=#ywlb:VARCHAR#
			]]>
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="ywList">
			<![CDATA[
	      	   lb.ywlb in ($ywList$)
			]]>
	    </isNotEmpty>
	     <isNotEmpty prepend="AND" property="bz">
			<![CDATA[
	      	   zbbz.bz=#bz:VARCHAR#
			]]>
	    </isNotEmpty>
	     <isNotEmpty prepend="AND" property="sdbs">
			<![CDATA[
	      	   sd.sdbs=#sdbs:VARCHAR#
			]]>
		</isNotEmpty>
    </select>
    
    <!-- 异步加载行员信息 -->
	<select id="KHDX_SYSTEM_LoadHyInfo" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		select jg.jgmc,hy.khdxdh ,hy.hymc,hy.hydh,cy.jgkhdxdh,jg.jgdh  from KHDX_HYhy,KHDX_JG jg,KHDX_JGCY cy
		
		inner join table(FN_GETSJJG_JAVA_QX($sysDate$,$dlhykhdxdh$,0)) v  on cy.jgkhdxdh = v.khdxdh  and v.ckhy='Y' 
		
			where rtrim(hy.hydh)='$hydh$' and hy.khdxdh=cy.khdxdh and cy.jgkhdxdh=jg.khdxdh and $sysdate$ between cy.qsrq and cy.jsrq
			
	</select>
    
    
    
    <!-- 根据指标联动币种 -->
	<select id="query_queryutil_bz" parameterClass="java.util.Map"
		resultClass="java.util.HashMap">
		select distinct bzb.bz,bzb.bzzwmc from khdx_zb zb inner join khdx_zbbz zbbz on zb.zbdh=zbbz.zbdh 
        inner join csb_bz bzb on zbbz.bz=bzb.bz 
        <dynamic prepend="WHERE">
			<isNotEmpty prepend="and" property="zbdh">
			      zbbz.zbdh= #zbdh:INTEGER#
			</isNotEmpty>
	    </dynamic>
	    order by bzb.bz
	</select>
	
	<!-- 根据指标联动时段 -->
	<select id="query_queryutil_sdbs" parameterClass="java.util.Map"
		resultClass="java.util.HashMap">
		select distinct zbsd.sdbs,ms.dmms sdbsmc from khdx_zb zb inner join khdx_zbsd zbsd on zb.zbdh=zbsd.zbdh 
        inner join csb_dmms ms on ms.dmz=zbsd.sdbs and lower(ms.dmmc)='zbsdbs'
        <dynamic prepend="WHERE">
			<isNotEmpty prepend="and" property="zbdh">
			      zbsd.zbdh= #zbdh:INTEGER#
			</isNotEmpty>
	    </dynamic>
	     order by zbsd.sdbs
	</select>
	<select id="studio.selectJgListBySjJgdh" resultClass="java.util.HashMap"
		parameterClass="java.util.Map">
		SELECT CC.SJKHDXDH,JG.KHDXDH JGKHDXDH,JG.JGDH,JG.JGMC,CC.JGJB,HY.KHDXDH,HY.HYDH,HY.HYMC
		FROM TABLE(FN_GETSJJG_JAVA_QXHY($tjrq$, $login_khdxdh$, $khdxdh$)) QX
		INNER JOIN KHDX_HY HY ON HY.KHDXDH = QX.KHDXDH
		INNER JOIN KHDX_JGCY CY ON cy.khdxdh=hy.khdxdh AND $tjrq$ BETWEEN CY.QSRQ AND CY.JSRQ
		INNER JOIN KHDX_JG JG ON CY.JGKHDXDH = JG.KHDXDH and JG.KHDXDH = $khdxdh$
		INNER JOIN KHDX_JGCC CC ON CC.KHDXDH = JG.KHDXDH  and $tjrq$ between cc.qsrq and cc.jsrq
		<dynamic>
			<isNotEqual compareValue="true" property="isDisplayXN" prepend="WHERE">
				hy.hydh not like '%XN%'
			</isNotEqual>
		</dynamic>
		ORDER BY HY.HYDH
	</select>
	
	<!-- 根据上级机构把所有的机构和行员列表查询出来 -->
	<select id="studio.selectJgListBySjJgdhNotHykhdxdh" resultMap="query_JgResult"
		parameterClass="java.util.Map">
		 select a.sjkhdxdh,a.khdxdh,jg.jgdh,jg.jgmc,cc.jgjb from table(FN_GETSJJG_JAVA_QX($tjrq$,$login_khdxdh$,$khdxdh$)) a 
		 inner join KHDX_JG jg on jg.khdxdh = a.khdxdh   inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh  
		 where $tjrq$ between cc.qsrq and cc.jsrq 
		  order by jg.pxbz 
	</select>
	<!--查询总行机构信息 -->
	<select id="studio.selectZhJgInfo" resultMap="query_JgResult"
		parameterClass="java.util.Map">
	select jg.khdxdh,jg.jgdh,jg.jgmc,jgcc.sjkhdxdh,jgcc.jgjb from KHDX_JGCC jgcc inner join KHDX_JG jg on jg.khdxdh=jgcc.khdxdh and jgcc.sjkhdxdh=0
	</select>
	<!--查询该机构是否为上级机构 -->
	<select id="studio.jgIsSjjg"  resultClass="java.util.HashMap" parameterClass="java.util.Map">
		select jg.khdxdh,
		case when (select count(1) from  KHDX_JGCC jgcc where jgcc.sjkhdxdh=jg.khdxdh and  
		           $tjrq$ between jgcc.qsrq and jgcc.jsrq)>0 then 'true' else 'false' end isParent
		from KHDX_JG jg 
	</select>
	<!--查询顶级机构和第一级机构 -->
	<select id="studio.getFirstFoorJg"  resultClass="java.util.HashMap" parameterClass="java.util.Map">
		 select jgcc.khdxdh
		 from KHDX_JGCC jgcc inner join KHDX_JG jg on jg.khdxdh=jgcc.khdxdh 
		 where (sjkhdxdh in
		    (select khdxdh from KHDX_JGCC where sjkhdxdh=0 and $tjrq$ between qsrq and jsrq)
		      or sjkhdxdh=0)
		      and $tjrq$ between qsrq and jsrq order by jg.pxbz
	</select>
	<!--根据上级机构查询子机构：只查第一层的子机构 -->
	<select id="studio.getJgByPid"  resultClass="java.util.HashMap" parameterClass="java.util.Map">
		select jg.khdxdh from KHDX_JGCC jgcc inner join KHDX_JG jg on jg.khdxdh=jgcc.khdxdh 
       where sjkhdxdh=$pid$ and $tjrq$ between qsrq and jsrq order by jg.pxbz
	</select>
	<!-- 二、更改核心权限后使用的SQL -->
	<select id="studio.selectJgListBySjJgdh.search" resultClass="java.util.HashMap" parameterClass="java.util.Map">
		select hy.hymc username,hy.hydh,hy.khdxdh userid,cy.jgkhdxdh,'a' as py from KHDX_HYhy
	  inner join KHDX_JGCY cy on cy.khdxdh=hy.khdxdh
	  inner join TABLE(FN_GETSJJG_JAVA_QXHY($tjrq$, $hykhdxdh$, 0)) QX on qx.khdxdh=cy.khdxdh
	  where  
	   $tjrq$ between cy.qsrq and cy.jsrq
	  <dynamic>
			<isNotEqual compareValue="true" property="isDisplayXN"
				prepend="and">
				hy.hydh not like '%XN%'
			</isNotEqual>
		</dynamic>
	  and (hy.hydh like '%$key$%' or hy.hymc like '%$key$%' )
	</select>
	
	  <resultMap id="jgTree_JgEntity" class="com.tiancom.mpas.pojo.Jg" >
	    <result column="khdxdh" property="khdxdh" jdbcType="INTEGER" />
	    <result column="jgdh" property="jgdh" jdbcType="VARCHAR" />
	    <result column="jgmc" property="jgmc" jdbcType="VARCHAR" />
	    <result column="sjkhdxdh" property="sjkhdxdh" jdbcType="INTEGER" />
	    <result column="jgjb" property="jgjb" jdbcType="INTEGER" />
	  </resultMap>
	
	<statement id="jgTree_selectRootJg" resultMap="jgTree_JgEntity" parameterClass="java.util.Map">
		select jg.jgdh, jg.khdxdh, jg.jgmc, cc.sjkhdxdh sjkhdxdh, cc.jgjb 
		from KHDX_JG jg 
		inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh
		where cc.sjkhdxdh=0 and jsrq=29991231
	</statement>
	
	<statement id="jgTree_selectJgByKhdxdh" resultMap="jgTree_JgEntity" parameterClass="java.util.Map">
		select jg.jgdh, jg.khdxdh, jg.jgmc, cc.sjkhdxdh, cc.jgjb 
		from KHDX_JG jg 
		inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh
		where jg.khdxdh=#khdxdh# and jsrq=29991231
	</statement>
	
	<statement id="jgTree_selectJgChildren" resultMap="jgTree_JgEntity" parameterClass="java.util.Map">
		select jg.jgdh, jg.khdxdh, jg.jgmc, cc.sjkhdxdh, cc.jgjb 
		from KHDX_JG jg 
		inner join KHDX_JGCC cc on cc.khdxdh=jg.khdxdh
		where cc.sjkhdxdh=#khdxdh# and jsrq=29991231
		order by jg.pxbz
	</statement>
	
	<statement id="jgTree_selectParentJg" resultMap="jgTree_JgEntity" parameterClass="java.util.Map">
		select jg.jgdh, jg.khdxdh, jg.jgmc, cc.sjkhdxdh, cc.jgjb 
		from KHDX_JG jg 
		inner join KHDX_JGCC cc on cc.sjkhdxdh=jg.khdxdh
		where cc.khdxdh=#khdxdh# and jsrq=29991231
	</statement>
</sqlMap>
